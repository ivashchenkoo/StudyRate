@model IQueryable<Mark>

@{
    ViewData["Title"] = "Index";
}

<div id="content">
    <div class="inner">
        <article class="box post post-excerpt">
            <header>
                <div id="Найкращі студенти" class="tabcontent">
                    <h2><a href="#">Найкращі студенти</a></h2>
                    <p>A free, fully responsive HTML5 site template by HTML5 UP</p>
                    @if (Model.Any())
                    {
                        var Model1 = Model.GroupBy(t => new { StudentID = t.StudentID })
                                    .Select(g => new { Average = g.Average(p => p.Score), Count = g.Count(), Id = g.Key.StudentID })
                                    .OrderByDescending(el => el.Average);
                        int i = 0;
                        <div class="table-responsive-sm">
                            <table class="table">
                                <thead class="thead-dark">
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">ПІБ</th>
                                        <th scope="col">Факультет</th>
                                        <th scope="col">Група</th>
                                        <th scope="col">Курс</th>
                                        <th scope="col">Рік</th>
                                        <th scope="col">Оцінок</th>
                                        <th scope="col">Рейтинг</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var entity in Model1)
                                    {
                                        var ent = Model.FirstOrDefault(x => x.StudentID == entity.Id);
                                        <tr>
                                            <th scope="row">@(++i)</th>
                                            <td>@ent.Student.FirstName @ent.Student.MiddleName @ent.Student.LastName</td>
                                            <td>@ent.Student.Group.Specialty.Faculty.ShortForm</td>
                                            <td>@ent.Student.Group.Name</td>
                                            <td>@(DateTime.Now.Year - ent.Student.Group.YearOfEntering)</td>
                                            <td>@ent.Student.Group.YearOfEntering</td>
                                            <td>@Model1.FirstOrDefault(x => x.Id == ent.StudentID).Count</td>
                                            <td>@Math.Round(Model1.FirstOrDefault(x => x.Id == ent.StudentID).Average, 3)</td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                        i = 0;
                    }
                </div>
                <div id="Рейтинг груп" class="tabcontent">
                    <h2><a href="#">Рейтинг груп</a></h2>
                    <p>A free, fully responsive HTML5 site template by HTML5 UP</p>
                    @if (Model.Any())
                    {
                        var Model1 = Model.GroupBy(t => new { StudentID = t.StudentID })
                                    .Select(g => new { Average = g.Average(p => p.Score), Count = g.Count(), Id = g.Key.StudentID })
                                    .OrderByDescending(el => el.Average);
                        int i = 0;
                        <table class="table">
                            <thead class="thead-dark">
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">ПІБ</th>
                                    <th scope="col">Факультет</th>
                                    <th scope="col">Група</th>
                                    <th scope="col">Курс</th>
                                    <th scope="col">Рік</th>
                                    <th scope="col">Оцінок</th>
                                    <th scope="col">Рейтинг</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var entity in Model1)
                                {
                                    var ent = Model.FirstOrDefault(x => x.StudentID == entity.Id);
                                    <tr>
                                        <th scope="row">@(++i)</th>
                                        <td>@ent.Student.FirstName @ent.Student.MiddleName @ent.Student.LastName</td>
                                        <td>@ent.Student.Group.Specialty.Faculty.ShortForm</td>
                                        <td>@ent.Student.Group.Name</td>
                                        <td>@(DateTime.Now.Year - ent.Student.Group.YearOfEntering)</td>
                                        <td>@ent.Student.Group.YearOfEntering</td>
                                        <td>@Model1.FirstOrDefault(x => x.Id == ent.StudentID).Count</td>
                                        <td>@Math.Round(Model1.FirstOrDefault(x => x.Id == ent.StudentID).Average, 3)</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                        i = 0;
                    }
                </div>
                <div id="Кількість студентів" class="tabcontent">
                    <h2><a href="#">Кількість студентів</a></h2>
                    <p>A free, fully responsive HTML5 site template by HTML5 UP</p>
                    @if (Model.Any())
                    {
                        var Model1 = Model.GroupBy(t => new { StudentID = t.StudentID })
                                    .Select(g => new { Average = g.Average(p => p.Score), Count = g.Count(), Id = g.Key.StudentID })
                                    .OrderByDescending(el => el.Average);
                        int i = 0;
                        <table class="table">
                            <thead class="thead-dark">
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">ПІБ</th>
                                    <th scope="col">Факультет</th>
                                    <th scope="col">Група</th>
                                    <th scope="col">Курс</th>
                                    <th scope="col">Рік</th>
                                    <th scope="col">Оцінок</th>
                                    <th scope="col">Рейтинг</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var entity in Model1)
                                {
                                    var ent = Model.FirstOrDefault(x => x.StudentID == entity.Id);
                                    <tr>
                                        <th scope="row">@(++i)</th>
                                        <td>@ent.Student.FirstName @ent.Student.MiddleName @ent.Student.LastName</td>
                                        <td>@ent.Student.Group.Specialty.Faculty.ShortForm</td>
                                        <td>@ent.Student.Group.Name</td>
                                        <td>@(DateTime.Now.Year - ent.Student.Group.YearOfEntering)</td>
                                        <td>@ent.Student.Group.YearOfEntering</td>
                                        <td>@Model1.FirstOrDefault(x => x.Id == ent.StudentID).Count</td>
                                        <td>@Math.Round(Model1.FirstOrDefault(x => x.Id == ent.StudentID).Average, 3)</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                        i = 0;
                    }
                </div>
                <div id="Успішність університету" class="tabcontent">
                    <h2><a href="#">Успішність університету</a></h2>
                    <p>A free, fully responsive HTML5 site template by HTML5 UP</p>
                    @if (Model.Any())
                    {
                        var Model1 = Model.GroupBy(t => new { StudentID = t.StudentID })
                                    .Select(g => new { Average = g.Average(p => p.Score), Count = g.Count(), Id = g.Key.StudentID })
                                    .OrderByDescending(el => el.Average);
                        int i = 0;
                        <table class="table">
                            <thead class="thead-dark">
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">ПІБ</th>
                                    <th scope="col">Факультет</th>
                                    <th scope="col">Група</th>
                                    <th scope="col">Курс</th>
                                    <th scope="col">Рік</th>
                                    <th scope="col">Оцінок</th>
                                    <th scope="col">Рейтинг</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var entity in Model1)
                                {
                                    var ent = Model.FirstOrDefault(x => x.StudentID == entity.Id);
                                    <tr>
                                        <th scope="row">@(++i)</th>
                                        <td>@ent.Student.FirstName @ent.Student.MiddleName @ent.Student.LastName</td>
                                        <td>@ent.Student.Group.Specialty.Faculty.ShortForm</td>
                                        <td>@ent.Student.Group.Name</td>
                                        <td>@(DateTime.Now.Year - ent.Student.Group.YearOfEntering)</td>
                                        <td>@ent.Student.Group.YearOfEntering</td>
                                        <td>@Model1.FirstOrDefault(x => x.Id == ent.StudentID).Count</td>
                                        <td>@Math.Round(Model1.FirstOrDefault(x => x.Id == ent.StudentID).Average, 3)</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                        i = 0;
                    }
                </div>
            </header>
            <div class="info">
                <span class="date"><span class="month">Jul<span>y</span></span> <span class="day">14</span><span class="year">, 2014</span></span>
                <ul class="stats">
                    <li><a href="#" class="icon fa-comment">16</a></li>
                    <li><a href="#" class="icon fa-heart">32</a></li>
                    <li><a href="#" class="icon brands fa-twitter">64</a></li>
                    <li><a href="#" class="icon brands fa-facebook-f">128</a></li>
                </ul>
            </div>
            <a href="#" class="image featured"><img src="images/pic01.jpg" alt="" /></a>
        </article>
    </div>
</div>

